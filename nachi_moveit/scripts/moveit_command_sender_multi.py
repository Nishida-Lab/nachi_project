#!/usr/bin/env python

import moveit_commander
import rospy
import geometry_msgs.msg
import copy

def main():
    rospy.init_node("moveit_command_sender")

    robot = moveit_commander.RobotCommander()

    print "=" * 10, " Robot Groups:"
    print robot.get_group_names()

    print "=" * 10, " Printing robot state"
    print robot.get_current_state()
    print "=" * 10

    arm = moveit_commander.MoveGroupCommander("arm")

    print "=" * 15, " Arm ", "=" * 15
    print "=" * 10, " Reference frame: %s" % arm.get_planning_frame()

    print "=" * 10, " Reference frame: %s" % arm.get_end_effector_link()

    arm_initial_pose = arm.get_current_pose().pose
    print "=" * 10, " Printing initial pose: "
    print arm_initial_pose

    target_pose = geometry_msgs.msg.Pose()

    target_pose.position.x = 0.5
    target_pose.position.y = -0.25
    target_pose.position.z = 0.5
    target_pose.orientation.x = 0.0
    target_pose.orientation.y = 0.0
    target_pose.orientation.z = 0.0
    target_pose.orientation.w = 1.0
    arm.set_pose_target(target_pose)

    print "=" * 10, " plan1..."
    arm.go()
    rospy.sleep(2)

    print "=" * 10, " Planning to a joint-space goal"
    arm.clear_pose_targets()
    print "=" * 10, " Joint values: ", arm.get_current_joint_values()

    target_pose.position.x = 0.4
    target_pose.position.y = -0.15
    target_pose.position.z = 0.6
    target_pose.orientation.x = 0.0
    target_pose.orientation.y = 0.0
    target_pose.orientation.z = 0.0
    target_pose.orientation.w = 1.0
    arm.set_pose_target(target_pose)

    print "=" * 10, " plan2..."
    arm.go()
    rospy.sleep(2)

    print "=" * 10, " Planning to a joint-space goal"
    arm.clear_pose_targets()
    print "=" * 10, " Joint values: ", arm.get_current_joint_values()

    target_pose.position.x = 0.4
    target_pose.position.y = 0.4
    target_pose.position.z = 0.4
    target_pose.orientation.x = 0.0
    target_pose.orientation.y = 0.0
    target_pose.orientation.z = 0.0
    target_pose.orientation.w = 1.0
    arm.set_pose_target(target_pose)

    print "=" * 10, " plan3..."
    arm.go()
    rospy.sleep(2)

    print "=" * 10, " Cartesian Paths"
    waypoints = []

    waypoints.append(arm.get_current_pose().pose)

    wpose = geometry_msgs.msg.Pose()
    wpose.orientation.w = 1.0
    wpose.position.x = waypoints[0].position.x
    wpose.position.y = waypoints[0].position.y - 0.15
    wpose.position.z = waypoints[0].position.z
    waypoints.append(copy.deepcopy(wpose))

    wpose.position.y -= 0.2
    wpose.position.z -= 0.2
    waypoints.append(copy.deepcopy(wpose))

    wpose.position.z += 0.2
    waypoints.append(copy.deepcopy(wpose))

    (plan, fraction) = arm.compute_cartesian_path(waypoints, 0.01, 0.0)

    print "=" * 10, " plan4..."
    arm.execute(plan)
    rospy.sleep(5)

if __name__ == '__main__':
    try:
        main()
    except rospy.ROSInterruptException:
        pass
